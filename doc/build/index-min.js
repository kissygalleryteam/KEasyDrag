/*!build time : 2014-03-12 10:06:18 AM*/
KISSY.add("kg/KEasyDrag/2.0.0/index",function(a,b,c){function d(a){var b=this;d.superclass.constructor.call(b,a),b.easydrag()}var e,f,g,h,i=b.all,j=!1,k=null,l={},m={},n={},o={},p={},q={},r=!1,s=function(a){var b=0,c=0,a=a||window.event;return a.pageX||a.pageY?(b=a.pageX,c=a.pageY):(a.clientX||a.clientY)&&(b=a.clientX+document.body.scrollLeft,c=a.clientY+document.body.scrollTop),{x:b,y:c}},t=function(a){var b=s(a),c=b.x-e,d=b.y-f;if(q||(q={}),!q.stopDragParent){var j=g+d,l=h+c,m=p[k.id];if(m){var n=m.offset(),o=m.width(),r=m.height(),t=i(k).width(),u=i(k).height();l<n.left?l=n.left:l+t>n.left+o&&(l=n.left+o-t),j<n.top?j=n.top:j+u>n.top+r&&(j=n.top+r-u)}q.easydragTop=j,q.easydragLeft=l,i(k).css("top",q.easydragTop),i(k).css("left",q.easydragLeft)}};return i(document).on("mousemove",function(a){return j&&0!=o[k.id]?(t(a),void 0!=m[k.id]&&m[k.id](a,k),!1):void 0}),i(document).on("mouseup",function(a){return j&&0!=o[k.id]?(j=!1,void 0!=l[k.id]&&l[k.id](a,k),!1):void 0}),a.extend(d,c,{ondrag:function(b){var c=this.get("elems");return a.each(c,function(a){m[a.id]=b}),this},ondrop:function(b){var c=this.get("elems");return a.each(c,function(a){l[a.id]=b}),this},dragoff:function(){var b=this.get("elems");return a.each(b,function(a){o[a.id]="off"}),this},dragOn:function(){var b=this.get("elems");return a.each(b,function(a){o[a.id]="on"}),this},setHandler:function(b){var c=this.get("elems");return a.each(c,function(a){n[a.id]=!0,i(a).css("cursor",""),o[a.id]="handler",i(b).css("cursor","move"),i(b).on("mousedown",function(b){r=!0,i(a).fire("mousedown",b)}),i(b).on("mouseup",function(){r=!1})}),this},setConstrain:function(b){var c=this.get("elems");return a.each(c,function(a){p[a.id]=i(b)}),this},easydrag:function(){var b=this.get("elems"),c=this.get("allowBubbling");return a.each(b,function(a){void 0!=a.id&&a.id.length||(a.id="easydrag"+ +new Date),n[a.id]=c?!0:!1,o[a.id]="on",i(a).css("cursor","move"),i(a).on("mousedown",function(b){if("off"==o[a.id]||"handler"==o[a.id]&&!r)return n[a.id];i(a).css("position","absolute"),i(a).css("z-index",parseInt((new Date).getTime()/1e3)),j=!0,k=this;var c=s(b);e=c.x,f=c.y,g=a.offsetTop,h=a.offsetLeft,t(b)})}),this}},{ATTRS:{elems:{value:"",setter:function(a){return i(a)}},allowBubbling:{value:!1}}}),d},{requires:["node","base"]});